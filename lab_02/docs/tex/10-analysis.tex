\chapter{Аналитическая часть}

В этом разделе будут представлены описания алгоритмов умножения матриц.

Задачи лабораторной работы:
\begin{itemize}
	\item изучить и реализовать стандартный алгоритм умножения матриц;
	\item изучить и реализовать алгоритм Винограда умножения матриц;
	\item оптимизировать алгоритм Винограда умножения матриц;
	\item оценить трудоёмкость реализаций алгоритмов умножения матриц теоретически;
	\item сравнить временные характеристики вышеизложенных алгоритмов экспериментально.
\end{itemize}

Матрица -- объект, записываемый в виде прямоугольной таблицы элементов, которая представляет собой совокупность строк и столбцов, на пересечении которых находятся её элементы \ref{eq:ref1}.
\begin{equation}
	A = \left(
	\begin{array}{cccc}
			a_{11} & a_{12} & \ldots & a_{1m} \\
			a_{21} & a_{22} & \ldots & a_{2m} \\
			\vdots & \vdots & \ddots & \vdots \\
			a_{n1} & a_{n2} & \ldots & a_{nm}
		\end{array}
	\right)
	\label{eq:ref1}
\end{equation}

Произведение матриц $AB$ состоит из всех возможных комбинаций скалярных произведений вектор-строк матрицы $A$ и вектор-столбцов матрицы $B$ \ref{img:mul}.

\img{100mm}{mul}{Произведение матриц}

\section{Стандартный алгоритм умножения матриц}

Пусть даны матрицы $A$ размерностью $n \times k$ и $B$ размерностью $k \times m$.
Тогда матрица $C = AB$ будет размерностью $n \times q$, а каждый элемент матрицы $C$ выражается формулой \ref{eq:ref3}.
\begin{equation}
	\begin{array}{cc}
		c_{ij} = \sum\limits_{l=1}^k a_{il}b_{lj} \quad (i=\overline{1,n}; j=\overline{1,m})
	\end{array}
	\label{eq:ref3}
\end{equation}

\section{Умножение матриц по Винограду}

В исходной версии асимптотическая сложность алгоритма составляла $O(n^{2,3755})$, где $n$ -- размер стороны матрицы.
Алгоритм Винограда, с учетом серии улучшений и доработок в последующие годы, обладает лучшей асимптотикой среди известных алгоритмов умножения матриц.
На практике алгоритм Винограда не используется, так как он имеет очень большую константу пропорциональности и начинает выигрывать в быстродействии у других известных алгоритмов только для матриц, размер которых превышает память современных компьютеров.

Каждый элемент в матрице $C$, которая является результатом умножения двух матриц, представляет собой скалярное произведение соответствующих строки и столбца исходных матриц. 
В алгоритме умножение матриц по Винограду предложено сделать предварительную обработку, позволяющую часть работы выполнить заранее.

Рассмотрим два вектора $V = (v_1, v_2, v_3, v_4)$ и $W = (w_1, w_2, w_3, w_4)$.
Их скалярное произведение вычисляется по формуле  \ref{eq:ref6}.
\begin{equation}
	V \cdot W = v_1w_1 + v_2w_2 + v_3w_3 + v_4w_4
	\label{eq:ref6}
\end{equation}
Равенство \ref{eq:ref6} можно записать в виде \ref{eq:ref7}.
\begin{equation}
	\begin{array}{l}
		V \cdot W = (v_1 + w_2)(v_2 + w_1) + (v_3 + w_4)(v_4 + w_3) - \\
		\quad \quad \quad v_1v_2 - v_3v_4 - w_1w_2 - w_3w_4
	\end{array}
	\label{eq:ref7}
\end{equation}

Несмотря на то, что второе выражение \ref{eq:ref7} требует вычисления большего количества операций, чем стандартный алгоритм, выражение в правой части последнего равенства допускает предварительную обработку.
Его части можно вычислить заранее и запомнить для каждой строки первой матрицы и для каждого столбца второй, поэтому для каждого элемента будет необходимо выполнить лишь первые два умножения и последующие пять сложений, а также дополнительно два сложения. 
Из-за того, что операция сложения быстрее операции умножения, алгоритм должен работать быстрее стандартного.

Стоит упомянуть, что при нечётном значении размера матрицы нужно дополнительно добавить произведения крайних элементов соответствующих строк и столбцов.

\section*{Вывод}

В данном разделе были рассмотрены алгоритмы классического умножения матриц и алгоритм Винограда.
Выявлено основное отличие, за счёт которого, алгоритм Винограда должен работать быстрее -- предварительная обработка данных, а так же снижение количества операций умножения.
